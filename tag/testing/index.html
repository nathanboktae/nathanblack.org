<!DOCTYPE html><html><head><title>#testing - Nathan Black</title><meta charset="utf-8"><meta name="description" content="A blog about modern web development, from front end to Node.js, JavaScript, styling, testing, and software development practices"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/png" href="/favicon.png"><link rel="stylesheet" href="/site.b7837c4.css"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:300,400|Raleway|Nobile:400,700"></head><body><header><aside><a href="https://github.com/nathanboktae" class="github"></a><a href="https://linkedin.com/in/nathanjblack" class="linkedin"></a><a href="mailto:nathan@nathanblack.org" class="email"></a></aside><div class="logo"><img src="//gravatar.com/avatar/f78c2c988486648311bcf116070e2487.jpg?s=110"></div><h2><a href="/"><span class="name">nathanblack</span><span>.org</span></a></h2><h4>Refining Modern Web Development</h4></header><aside class="github"><h2><a href="https://github.com/nathanboktae"><b>@</b>nathanboktae</a></h2><ul data-bind="foreach: events" class="events"><li data-bind="attr: { class: type }"><span data-bind="text: when" class="date"></span><h3 data-bind="html: summary"></h3><p data-bind="text: $data.details"></p></li></ul></aside><article><h2 class="tag">testing</h2><section class="post-summary truncated"><span class="date">Monday, January 30th 2017</span><h1><a href="/post/dont-mock-your-code-the-behavior-is-the-unit">Don't Mock Your Code - The Behavior is the Unit</a></h1><article><p>I first started really utilizing unit testing and test-driven development while on the <a href="http://web.archive.org/web/20120205035354/https://datamarket.azure.com/">DataMarket</a> team at Microsoft was slowing migrating an ASP.NET WebForms app to MVC. In a team that had no tests maintained by developers (<em>shudder</em> how did we develop software this long?) it was a big cultural change led by my great colleages <a href="https://github.com/jonsequitur">Jon Sequiera</a> and <a href="https://www.linkedin.com/in/dfrenkel">Dmitry Frenkel</a>, who I am very greatful to have the experience of working with.</p>
<p>At the time we&#39;d write tests for our controllers. We&#39;d mock out all the dependencies it would need in a test and provide them. We were also using the <a href="">repository pattern</a> and testing the controller we&#39;d mock that out. The repository pattern was really needed as we couldn&#39;t actually make a call to the database due to a lot of different reasons that basically stem from a monolithic ball of sphagetti code and abomination that was <a href="http://www.ben-morris.com/entity-framework-anti-patterns-how-not-to-use-an-orm-with-sql-server/">Entity Framework 1.0</a>.</p>
<p>That was nice to get developers used to writing tests for their code, but there was a lot of problems with that. Views were not tested at all, due to Razor being untestable at the time (some 32bit vs 64bit issue on the build server or something, see previous comment on monolithic ball of sphagetti). We had bugs in our view not being rendered. Razor was also very logic heavy, and a few abominations were created. Writing new tests required about 3x the mocking code than code that actually did the assertions. Model binding had no tests - you&#39;d know about it 3 days later (maybe) when a tester ran their test suite, or worse, your manager was trying something on the development environment. Forgot a dependency injection registration that you mocked out? App won&#39;t boot at all despite your tests passing. Moreover, when I want to refactor code to move more logic into the controller from the repository that had to much (that had no tests on it), I have to refactor a whole quite of tests. How can we rely on these tests when it still has these huge gaps and maintence problems?
</article><ul class="tags"><li><a href="/tag/front-end">front-end</a></li><li><a href="/tag/testing">testing</a></li><li><a href="/tag/bdd">bdd</a></li></ul></section><section class="post-summary truncated"><span class="date">Thursday, September 17th 2015</span><h1><a href="/post/robustly-running-sauce-lab-test-in-circle-ci">A fast and robust way to run Sauce Labs tests in Circle CI</a></h1><article><p>We&#39;ve been using <a href="https://circleci.com">Circle CI</a> at <a href="http://www.appuri.com">Appuri</a> for many months now and have been very happy with it. It&#39;s very simple and has a great breadth of features, namely the ability to SSH into a build to diagnose it when things get really tricky, as well as docker build services, slack integration, and lots of built-in services. After I hit a wall with <a href="http://phantomjs.org">PhantomJS</a>, and needing to run our tests on multiple browsers anyways, it was time to integrate <a href="">Sauce Labs</a> to do our browser testing, which I&#39;ve had great experience with on <a href="https://github.com/nathanboktae/cherrytree-for-knockout">many</a> <a href="https://github.com/nathanboktae/frypan-knockout-grid">open source</a> <a href="https://github.com/nathanboktae/knockout-choose">projects</a>. In those projects I used <a href="https://github.com/axemclion/grunt-saucelabs">grunt-saucelabs</a> as I am not a big fan of Karma as I like to control the HTML page the tests run on as well as the simplicity of <a href="https://github.com/nathanboktae/mocha-phantomjs">mocha-phantomjs</a> and just refreshing a flat file or using <a href="http://www.browsersync.io/">browser sync</a>.</p>
<p>However we&#39;re using <a href="http://gulpjs.com/">gulp</a> and I didn&#39;t want to pull in <a href="http://gruntjs.com/">grunt</a> and have two build systems. Unfortunately there&#39;s no <code>gulp-saucelabs</code>, which I contemplated doing (I may sometime), but I found I could simply use <a href="https://github.com/nathanboktae/mocha-cloud">mocha-cloud</a>. However, it didn&#39;t bring up the tunnel.</p>
</article><ul class="tags"><li><a href="/tag/continuous-integration">continuous-integration</a></li><li><a href="/tag/testing">testing</a></li><li><a href="/tag/front-end">front-end</a></li><li><a href="/tag/sauce-labs">sauce-labs</a></li><li><a href="/tag/circle-ci">circle-ci</a></li></ul></section></article><script src="/site.b7837c4.js"></script></body></html>